<template>
<div class="subheader py-2 py-lg-12 subheader-transparent" id="kt_subheader">
							<div class="container d-flex align-items-center justify-content-between flex-wrap flex-sm-nowrap">
								<div class="d-flex align-items-center flex-wrap mr-1">
									<div class="d-flex flex-column">
										<h2 class="text-white font-weight-bold my-2 mr-5">Informasi Perusahaan</h2>
										<div class="d-flex align-items-center font-weight-bold my-2">
										</div>
									</div>
								</div>
							</div>
						</div>
   <div class="content d-flex flex-column flex-column-fluid" id="kt_content">
      <div class="d-flex flex-column-fluid">
							<!--begin::Container-->
							<div class="container mb-13">   
										<!--begin::Card-->
										<div class="card card-custom gutter-bs">
											<!--Begin::Header-->
											<div class="card-header card-header-tabs-line">
												<div class="card-toolbar">
													<ul class="nav nav-tabs nav-tabs-space-lg nav-tabs-line nav-tabs-bold nav-tabs-line-3x" role="tablist">
														<li class="nav-item mr-3">
															<a class="nav-link active" data-toggle="tab" href="#kt_apps_contacts_view_tab_2">
																<span class="nav-icon mr-2">
																	<span class="svg-icon mr-3">
																		<!--begin::Svg Icon | path:assets/media/svg/icons/Communication/Chat-check.svg-->
																		<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1">
																			<g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
																				<rect x="0" y="0" width="24" height="24" />
																				<path d="M4.875,20.75 C4.63541667,20.75 4.39583333,20.6541667 4.20416667,20.4625 L2.2875,18.5458333 C1.90416667,18.1625 1.90416667,17.5875 2.2875,17.2041667 C2.67083333,16.8208333 3.29375,16.8208333 3.62916667,17.2041667 L4.875,18.45 L8.0375,15.2875 C8.42083333,14.9041667 8.99583333,14.9041667 9.37916667,15.2875 C9.7625,15.6708333 9.7625,16.2458333 9.37916667,16.6291667 L5.54583333,20.4625 C5.35416667,20.6541667 5.11458333,20.75 4.875,20.75 Z" fill="#000000" fill-rule="nonzero" opacity="0.3" />
																				<path d="M2,11.8650466 L2,6 C2,4.34314575 3.34314575,3 5,3 L19,3 C20.6568542,3 22,4.34314575 22,6 L22,15 C22,15.0032706 21.9999948,15.0065399 21.9999843,15.009808 L22.0249378,15 L22.0249378,19.5857864 C22.0249378,20.1380712 21.5772226,20.5857864 21.0249378,20.5857864 C20.7597213,20.5857864 20.5053674,20.4804296 20.317831,20.2928932 L18.0249378,18 L12.9835977,18 C12.7263047,14.0909841 9.47412135,11 5.5,11 C4.23590829,11 3.04485894,11.3127315 2,11.8650466 Z M6,7 C5.44771525,7 5,7.44771525 5,8 C5,8.55228475 5.44771525,9 6,9 L15,9 C15.5522847,9 16,8.55228475 16,8 C16,7.44771525 15.5522847,7 15,7 L6,7 Z" fill="#000000" />
																			</g>
																		</svg>
																		<!--end::Svg Icon-->
																	</span>
																</span>
																<span class="nav-text font-weight-bold">Profile Perusahaan</span>
															</a>
														</li>
														<li class="nav-item mr-3">
															<a class="nav-link" data-toggle="tab" href="#kt_apps_contacts_view_tab_3">
																<span class="nav-icon mr-2">
																	<span class="svg-icon mr-3">
																		<!--begin::Svg Icon | path:assets/media/svg/icons/Devices/Display1.svg-->
																		<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1">
																			<g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
																				<rect x="0" y="0" width="24" height="24" />
																				<path d="M11,20 L11,17 C11,16.4477153 11.4477153,16 12,16 C12.5522847,16 13,16.4477153 13,17 L13,20 L15.5,20 C15.7761424,20 16,20.2238576 16,20.5 C16,20.7761424 15.7761424,21 15.5,21 L8.5,21 C8.22385763,21 8,20.7761424 8,20.5 C8,20.2238576 8.22385763,20 8.5,20 L11,20 Z" fill="#000000" opacity="0.3" />
																				<path d="M3,5 L21,5 C21.5522847,5 22,5.44771525 22,6 L22,16 C22,16.5522847 21.5522847,17 21,17 L3,17 C2.44771525,17 2,16.5522847 2,16 L2,6 C2,5.44771525 2.44771525,5 3,5 Z M4.5,8 C4.22385763,8 4,8.22385763 4,8.5 C4,8.77614237 4.22385763,9 4.5,9 L13.5,9 C13.7761424,9 14,8.77614237 14,8.5 C14,8.22385763 13.7761424,8 13.5,8 L4.5,8 Z M4.5,10 C4.22385763,10 4,10.2238576 4,10.5 C4,10.7761424 4.22385763,11 4.5,11 L7.5,11 C7.77614237,11 8,10.7761424 8,10.5 C8,10.2238576 7.77614237,10 7.5,10 L4.5,10 Z" fill="#000000" />
																			</g>
																		</svg>
																		<!--end::Svg Icon-->
																	</span>
																</span>
																<span class="nav-text font-weight-bold">Akun Admin</span>
															</a>
														</li>
														<li class="nav-item mr-3">
															<a class="nav-link" data-toggle="tab" href="#kt_apps_contacts_view_tab_4">
																<span class="nav-icon mr-2">
																	<span class="svg-icon mr-3">
																		<!--begin::Svg Icon | path:assets/media/svg/icons/Home/Globe.svg-->
																		<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1">
																			<g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
																				<rect x="0" y="0" width="24" height="24" />
																				<path d="M13,18.9450712 L13,20 L14,20 C15.1045695,20 16,20.8954305 16,22 L8,22 C8,20.8954305 8.8954305,20 10,20 L11,20 L11,18.9448245 C9.02872877,18.7261967 7.20827378,17.866394 5.79372555,16.5182701 L4.73856106,17.6741866 C4.36621808,18.0820826 3.73370941,18.110904 3.32581341,17.7385611 C2.9179174,17.3662181 2.88909597,16.7337094 3.26143894,16.3258134 L5.04940685,14.367122 C5.46150313,13.9156769 6.17860937,13.9363085 6.56406875,14.4106998 C7.88623094,16.037907 9.86320756,17 12,17 C15.8659932,17 19,13.8659932 19,10 C19,7.73468744 17.9175842,5.65198725 16.1214335,4.34123851 C15.6753081,4.01567657 15.5775721,3.39010038 15.903134,2.94397499 C16.228696,2.49784959 16.8542722,2.4001136 17.3003976,2.72567554 C19.6071362,4.40902808 21,7.08906798 21,10 C21,14.6325537 17.4999505,18.4476269 13,18.9450712 Z" fill="#000000" fill-rule="nonzero" />
																				<circle fill="#000000" opacity="0.3" cx="12" cy="10" r="6" />
																			</g>
																		</svg>
																		<!--end::Svg Icon-->
																	</span>
																</span>
																<span class="nav-text font-weight-bold">Alamat Perusahaan</span>
															</a>
														</li>
														
													</ul>
												</div>
											</div>
											<!--end::Header-->
											<!--Begin::Body-->
											<div class="card-body px-0">
												<div class="tab-content pt-5">
													<!--begin::Tab Content-->
													<div class="tab-pane active" id="kt_apps_contacts_view_tab_2" role="tabpanel">
														<form class="form mb-18" v-for="(data) in infopt" :key="data.id">
															<!--begin::Heading-->
															<!--end::Heading-->
															<div class="form-group row">
																<label class="col-xl-3 col-lg-3 text-right col-form-label">Logo</label>
																<div class="col-lg-9 col-xl-9">
																	<div class="image-input image-input-outline image-input-circle" id="kt_user_avatar" style="background-image: url(assets/media/users/blank.png)">
																		<div class="image-input-wrapper" style="background-image: url(assets/media/svg/avatars/007-boy-2.svg)"></div>
																		<label class="btn btn-xs btn-icon btn-circle btn-white btn-hover-text-primary btn-shadow" data-action="change" data-toggle="tooltip" title="" data-original-title="Change avatar">
																			<i class="fa fa-pen icon-sm text-muted"></i>
																			<input type="file" name="profile_avatar" accept=".png, .jpg, .jpeg" />
																			<input type="hidden" name="profile_avatar_remove" />
																		</label>
																		<span class="btn btn-xs btn-icon btn-circle btn-white btn-hover-text-primary btn-shadow" data-action="cancel" data-toggle="tooltip" title="Cancel avatar">
																			<i class="ki ki-bold-close icon-xs text-muted"></i>
																		</span>
																		<span class="btn btn-xs btn-icon btn-circle btn-white btn-hover-text-primary btn-shadow" data-action="remove" data-toggle="tooltip" title="Remove avatar">
																			<i class="ki ki-bold-close icon-xs text-muted"></i>
																		</span>
																	</div>
																</div>
															</div>
															<div class="form-group row">
																<label class="col-xl-3 col-lg-3 text-right col-form-label">Nama Perusahaan</label>
																<div class="col-lg-9 col-xl-6">
																	<div class="form-control form-control-lg form-control-solid" type="text">{{data.nama_perusahaan}}</div>
																</div>
															</div>
															<div class="form-group row">
																<label class="col-xl-3 col-lg-3 text-right col-form-label">Email Perusahaan</label>
																<div class="col-lg-9 col-xl-6">
																	<div class="form-control form-control-lg form-control-solid" type="text" >{{data.email}}</div>
																</div>
															</div>
															<div class="form-group row">
																<label class="col-xl-3 col-lg-3 text-right col-form-label">Bergerak di Bidang</label>
																<div class="col-lg-9 col-xl-6">
																	<div class="form-control form-control-lg form-control-solid" type="text" >{{data.bidang}}</div>
																</div>
															</div>
															<div class="form-group row">
																<label class="col-xl-3 col-lg-3 text-right col-form-label">Jumlah Karyawan</label>
																<div class="col-lg-9 col-xl-6">
																	<div class="form-control form-control-lg form-control-solid" type="text" >{{data.jumlah_karyawan}}</div>
																</div>
															</div>
															<div class="form-group row">
																<label class="col-xl-3 col-lg-3 text-right col-form-label">NPWP</label>
																<div class="col-lg-9 col-xl-6">
																	<div class="form-control form-control-lg form-control-solid" type="text" >{{data.npwp}}</div>
																</div>
															</div>
											
														</form>
													</div>
													<!--end::Tab Content-->
													<!--begin::Tab Content-->
													<div class="tab-pane" id="kt_apps_contacts_view_tab_3" role="tabpanel">
														<form class="form mb-18" v-for="(data) in infopt" :key="data.id">
															
															<div class="form-group row">
																<label class="col-xl-3 col-lg-3 text-right col-form-label">Username</label>
																<div class="col-lg-9 col-xl-6">
																	<div class="input-group input-group-lg input-group-solid">
																		<div class="form-control form-control-lg form-control-solid" type="text" >{{data.name}}</div>
																	</div>
																</div>
															</div>
															<div class="form-group row">
																<label class="col-xl-3 col-lg-3 text-right col-form-label">Email</label>
																<div class="col-lg-9 col-xl-6">
																	<div class="input-group input-group-lg input-group-solid">
																		<div class="input-group-prepend">
																			<span class="input-group-text">
																				<i class="la la-at"></i>
																			</span>
																		</div>
																		<div class="form-control form-control-lg form-control-solid" type="text" >{{data.email}}</div>
																	</div>
																</div>
															</div>
														</form>
													</div>
													<!--end::Tab Content-->
													<!--begin::Tab Content-->
													<div class="tab-pane" id="kt_apps_contacts_view_tab_4" role="tabpanel">
														<form class="form mb-18" v-for="(data) in infopt" :key="data.id">
																<div class="form-group row">
																<label class="col-xl-3 col-lg-3 text-right col-form-label">Provinsi</label>
																<div class="col-lg-9 col-xl-6">
																	<div class="form-control form-control-lg form-control-solid" type="text">{{data.provinsi}}</div>
																</div>
															</div>
																<div class="form-group row">
																<label class="col-xl-3 col-lg-3 text-right col-form-label">Kota</label>
																<div class="col-lg-9 col-xl-6">
																	<div class="form-control form-control-lg form-control-solid" type="text">{{data.kota}}</div>
																</div>
															</div>
															<div class="form-group row">
																<label class="col-xl-3 col-lg-3 text-right col-form-label">Kode Pos</label>
																<div class="col-lg-9 col-xl-6">
																	<div class="form-control form-control-lg form-control-solid" type="text">{{data.kode_pos}}</div>
																</div>
															</div>
															<div class="form-group row">
																<label class="col-xl-3 col-lg-3 text-right col-form-label">Detail Alamat</label>
																<div class="col-lg-9 col-xl-6">
																	<textarea class="form-control form-control-lg form-control-solid" type="text" v-model="data.det_alamat"></textarea>
																</div>
															</div>
														</form>
													</div>
													<!--end::Tab Content-->
													<!--begin::Tab Content-->
													
												</div>
											</div>
											<!--end::Body-->
										</div>
										<!--end::Card-->
									</div>
									<!--end::Content-->
								</div>
								<!--end::Profile Personal Information-->
							</div>

    <div class="modal fade" id="editPegawai" tabindex="-1" role="dialog" aria-labelledby="staticBackdrop" aria-hidden="true">
															<div class="modal-dialog modal-dialog-scrollable modal-dialog-centered modal-lg" role="document">
																<div class="modal-content">
																	<div class="modal-header">
																		<h5 class="modal-title" id="editPegawai">Edit Data Pegawai</h5>
																		<button type="button" class="close" data-dismiss="modal" aria-label="Close">
																			<i aria-hidden="true" class="ki ki-close" @click="closeModal()"></i>
																		</button>
																	</div>
																	<div class="modal-body">
																		<div >
																		<form @submit.prevent="updateprofil()">
																			<div class="form-group row">
                                                                                <label class="col-xl-3 col-lg-3 col-form-label">Nama Lengkap</label>
                                                                                <div class="col-lg-9 col-xl-6">
                                                                                    <input v-model="form.nama_lengkap" class="form-control form-control-lg form-control-solid" type="name"/>
                                                                                </div>
                                                                            </div>
                                                                            <div class="form-group row">
                                                                                <label class="col-xl-3 col-lg-3 col-form-label">Pendidikan</label>
                                                                                <div class="col-lg-9 col-xl-6">
                                                                                    <input v-model="form.pendidikan" class="form-control form-control-lg form-control-solid" type="name"/>
                                                                                </div>
                                                                            </div>
                                                                             <div class="form-group row">
                                                                                <label class="col-xl-3 col-lg-3 col-form-label">No Identitas KTP</label>
                                                                                <div class="col-lg-9 col-xl-6">
                                                                                    <input v-model="form.no_ktp" class="form-control form-control-lg form-control-solid" type="name"/>
                                                                                </div>
                                                                            </div>
                                                                            <div class="form-group row">
                                                                                <label class="col-xl-3 col-lg-3 col-form-label">No Handphone</label>
                                                                                <div class="col-lg-9 col-xl-6">
                                                                                    <input v-model="form.no_hp" class="form-control form-control-lg form-control-solid" type="name"/>
                                                                                </div>
                                                                            </div>
                                                                             <div class="form-group row">
                                                                                <label class="col-xl-3 col-lg-3 col-form-label">Gender</label>
                                                                                <div class="col-lg-9 col-xl-6">
                                                                                   <select class="form-control form-control-lg form-control-solid" v-model="form.gender">
                                                                                            <option >Laki-Laki</option>
                                                                                            <option >Perempuan</option>
                                                                                        </select>
                                                                                </div>
                                                                            </div>
                                                                             <div class="form-group row">
                                                                                <label class="col-xl-3 col-lg-3 col-form-label">Alamat</label>
                                                                                <div class="col-lg-9 col-xl-6">
                                                                                    <textarea v-model="form.alamat" class="form-control form-control-lg form-control-solid" type="name"/>
                                                                                </div>
                                                                            </div>
																		</form>
																		</div>
																	</div>
																	<div class="modal-footer">
																		
																		<button type="submit" @click="updateprofil()"  class="btn btn-primary font-weight-bold">Update</button>
                                                                        <button type="button"  data-dismiss="modal" @click="closeModal()" class="btn btn-primary font-weight-bold">Batal</button>
																	</div>
																</div>
															</div>
														</div>

      
							<!--begin::Container-->

							<!--end::Container-->

</template>


<script>

export default {
    name: "Profile",
    data() {
        return {
            akunpegawai:[],
            pegawais:[],
            infopt:[],
            admin:[],
            jabatan:[],
             form : new Form({
                id : "",
                nama_lengkap : "",
                no_ktp : "",
                no_hp : "",
                pendidikan :"",
                gender : "",
                alamat : ""
            }),
            token: localStorage.getItem("token"),
            role: localStorage.getItem('role'),
        }
    },

    methods:{
         update(data) {
            // this.form.reset()

            this.form.fill({
                id: data.id,
                name: data.name,
                
            })
        },
        updateprofil() {
              axios.post('/api/updatedata', 
               {
                    id: this.form.id,
                    nama_lengkap: this.form.nama_lengkap,
                    no_ktp: this.form.no_ktp,
                    no_hp: this.form.no_hp,
                    gender: this.form.gender,
                    alamat: this.form.alamat,
                    pendidikan: this.form.pendidikan,
                },
                {
                    headers: { Authorization: "Bearer " + this.token }
                }).then((response) => {
                if (response.data.success){
                    Swal.fire({
                        icon: "success",
                        title: "Berhasil",
                        text: "Berhasil Update",
                        showConfirmButton: false,
                        timer: 1600,
                    })
                    $("#editPegawai").modal("hide")
                    this.getprofile()
                }
            
            })
           
        },
        showModal(data) {
            $("#editPegawai").modal("show");
            this.form.fill({
                nama_lengkap: data.nama_lengkap,
                pendidikan: data.pendidikan,
                no_ktp: data.no_ktp,
                no_hp: data.no_hp,
                gender: data.gender,
                alamat: data.alamat,
                
            })
        },
        closeModal() {
            $("#editPegawai").modal("hide");
        },
        isibiodata() {
            this.$axios.get('/sanctum/csrf-cookie').then(response => {
              this.form.post('/api/isibiodata', {
                    headers: {Authorization: "Bearer " + this.token},
                }).then((response) => {
                if (response.data.success){
                    Swal.fire({
                        icon: "success",
                        title: "Berhasil",
                        text: "Berhasil Melengkapi Biodata",
                        showConfirmButton: false,
                        timer: 1600,
                    })
                    $("#editPegawai").modal("hide")
                    this.getprofile()
                }
                
            
            }
        )
            })
        },
         lengkap() {
            this.$axios.get('/sanctum/csrf-cookie').then(response => {
              this.$axios.get('/api/isibiodata', {
                    headers: {Authorization: "Bearer " + this.token},
                }).then((response) => {
                if (email != null){
                    Swal.fire({
                        icon: "success",
                        title: "Berhasil",
                        text: "Berhasil",
                        showConfirmButton: false,
                        timer: 1600,
                    })
                }else{
                    this.showModal()
                }
                
            
            }
        )
            })
        },
         getprofile(){
            this.$axios.get('/sanctum/csrf-cookie').then(response => {
            this.$axios.get('/api/getprofile',{
                headers: {Authorization: "Bearer " + this.token},
            })
                .then(response => {
                    this.pegawais = response.data.data;
                })
                .catch(function (error) {
                    console.error(error);
                });
        })
        
        },
        getakun(){
            this.$axios.get('/sanctum/csrf-cookie').then(response => {
            this.$axios.get('/api/getakun',{
                headers: {Authorization: "Bearer " + this.token},
            })
                .then(response => {
                    this.akunpegawai = response.data.data;
                })
                .catch(function (error) {
                    console.error(error);
                });
        })
        },
         getpt(){
            this.$axios.get('/sanctum/csrf-cookie').then(response => {
            this.$axios.get('/api/infopt',{
                headers: {Authorization: "Bearer " + this.token},
            })
                .then(response => {
                    this.infopt = response.data.data;
                })
                .catch(function (error) {
                    console.error(error);
                });
        })
        },
         getAdmin(){
            this.$axios.get('/sanctum/csrf-cookie').then(response => {
            this.$axios.get('/api/getakunAdmin',{
                headers: {Authorization: "Bearer " + this.token},
            })
                .then(response => {
                    this.admin = response.data.data;
                })
                .catch(function (error) {
                    console.error(error);
                });
        })
        },
        getJabatan(){
            this.$axios.get('/sanctum/csrf-cookie').then(response => {
            this.$axios.get('/api/alljabatan',{
                headers: {Authorization: "Bearer " + this.token},
            })
                .then(response => {
                    this.jabatan = response.data.data;
                })
                .catch(function (error) {
                    console.error(error);
                });
        })
        },
        convertToRupiah(value) {
            // value = value.toString()
            value = parseFloat(value)
            let rupiah = ''
            let valueRev = value.toString().split('').reverse().join('')
            for (let i = 0; i < valueRev.length; i++) {
                if (i % 3 === 0) rupiah += `${valueRev.substr(i, 3)}.`
            }

            const rp = rupiah
                .split('', rupiah.length - 1)
                .reverse()
                .join('')
            // console.log('rupiah', isNaN(rp), rupiah.length, rp, rupiah)
            if (rupiah === 'NaN.' || rupiah === 'NaN') {
                return '...'
            }
            return `Rp ${rp}`
        },

    },
    mounted(){
        this.getJabatan();
        this.getpt();
        this.getAdmin();
    }
    


}


</script>
<style scope>

.form-control:focus {
    box-shadow: none;
    border-color: #124EB2;
}
input::placeholder {
    font-size: 12px;
}
textarea::placeholder {
    font-size: 12px;
}
.profile-button {
    background: #124EB2;
    box-shadow: none;
    border: none
}
.lengkapi-profile {
    background: #E95A09;
    box-shadow: none;
    border: none
}
.lengkapi-profile:hover {
    background: #E95A09;
    box-shadow: none;
    border: none
}

.profile-button:hover {
    background: #124EB2
}

.profile-button:focus {
    background: #124EB2;
    box-shadow: none
}

.profile-button:active {
    background: #682773;
    box-shadow: none
}

.back:hover {
    color: #124EB2;
    cursor: pointer
}

.labels {
    font-size: 13px
}
   
</style>


